import json
from datetime import datetime, timedelta

# ูุงู ุฐุฎุฑูโุณุงุฒ
fileName = "ฺฉุงุฑูุง.json"

# ุชุงุจุน ุจุฑุง ุจุฑุฑุณ ูุถุนุช
def ูุถุนุช(ูุถุนุช_ฺฉุงุฑ):
    if ูุถุนุช_ฺฉุงุฑ == "ุชููู ุดุฏู":
        return "โ ฺฉุงููพูุชุฑ ุชููู ุดุฏู"
    else:
        return "โ ูุถุนุช ุชููู ูุดุฏู"

# ูุญุงุณุจู ุชุงุฑุฎ ูพุงุงู
def ูุญุงุณุจู_ุชุงุฑุฎ_ูพุงุงู(ุชุงุฑุฎ_ุดุฑูุน, ูุฏุช_ุฒูุงู):
    ุดุฑูุน = datetime.strptime(ุชุงุฑุฎ_ุดุฑูุน, "%Y-%m-%d")
    ูพุงุงู = ุดุฑูุน + timedelta(days=ูุฏุช_ุฒูุงู)
    return ูพุงุงู.strftime("%Y-%m-%d")

# ููุงุด ูุณุช ฺฉุงุฑูุง
def ููุงุด_ฺฉุงุฑูุง():
    print("๐๏ธ ูุณุช ฺฉุงุฑูุง ูพุฑูฺู:")
    print("-" * 50)
    for i, ฺฉุงุฑ in enumerate(ฺฉุงุฑูุง_ูพุฑูฺู):
        ุชุงุฑุฎ_ูพุงุงู = ูุญุงุณุจู_ุชุงุฑุฎ_ูพุงุงู(ฺฉุงุฑ["ุชุงุฑุฎ_ุดุฑูุน"], ฺฉุงุฑ["ูุฏุช_ุฒูุงู"])
        print(f"{i+1}. ๐ ูุงู ฺฉุงุฑ: {ฺฉุงุฑ['ูุงู']}")
        print(f"   ๐ ุชุงุฑุฎ ุดุฑูุน: {ฺฉุงุฑ['ุชุงุฑุฎ_ุดุฑูุน']}")
        print(f"   ๐ ุชุงุฑุฎ ูพุงุงู: {ุชุงุฑุฎ_ูพุงุงู}")
        print(f"   โฑ๏ธ ูุฏุช ุฒูุงู: {ฺฉุงุฑ['ูุฏุช_ุฒูุงู']} ุฑูุฒ")
        print(f"   ๐ ูุถุนุช: {ูุถุนุช(ฺฉุงุฑ['ูุถุนุช'])}")
        print(f"   โญ ุงูููุช: {ฺฉุงุฑ['ุงูููุช']}")
        print("-" * 50)

# ูุฑุงุด ฺฉ ฺฉุงุฑ
def ูุฑุงุด_ฺฉุงุฑ(index):
    if 0 <= index < len(ฺฉุงุฑูุง_ูพุฑูฺู):
        ฺฉุงุฑ = ฺฉุงุฑูุง_ูพุฑูฺู[index]
        print(f"ุฏุฑ ุญุงู ูุฑุงุด: {ฺฉุงุฑ['ูุงู']}")
        ฺฉุงุฑ['ูุงู'] = input("ูุงู ุฌุฏุฏ: ") or ฺฉุงุฑ['ูุงู']
        ฺฉุงุฑ['ุชุงุฑุฎ_ุดุฑูุน'] = input("ุชุงุฑุฎ ุดุฑูุน ุฌุฏุฏ (yyyy-mm-dd): ") or ฺฉุงุฑ['ุชุงุฑุฎ_ุดุฑูุน']
        ูุฏุช = input("ูุฏุช ุฒูุงู ุฌุฏุฏ (ุฑูุฒ): ")
        if ูุฏุช:
            ฺฉุงุฑ['ูุฏุช_ุฒูุงู'] = int(ูุฏุช)
        ฺฉุงุฑ['ูุถุนุช'] = input("ูุถุนุช ุฌุฏุฏ (ุชููู ุดุฏู / ุฏุฑ ุญุงู ุงูุฌุงู): ") or ฺฉุงุฑ['ูุถุนุช']
        ฺฉุงุฑ['ุงูููุช'] = input("ุงูููุช ุฌุฏุฏ (ุจุงูุง / ูุชูุณุท / ฺฉู): ") or ฺฉุงุฑ['ุงูููุช']
    else:
        print("ุดูุงุฑู ูุงูุนุชุจุฑ ุงุณุช!")

# ุฐุฎุฑู ูุงู
def ุฐุฎุฑู_ุฏุฑ_ูุงู():
    with open(fileName, "w", encoding="utf-8") as f:
        json.dump(ฺฉุงุฑูุง_ูพุฑูฺู, f, ensure_ascii=False, indent=2)
    print("โ ุงุทูุงุนุงุช ุฐุฎุฑู ุดุฏ.")

# ุจุงุฑฺฏุฐุงุฑ ุงุฒ ูุงู
def ุจุงุฑฺฏุฐุงุฑ_ุงุฒ_ูุงู():
    try:
        with open(fileName, "r", encoding="utf-8") as f:
            return json.load(f)
    except FileNotFoundError:
        return []

# ุฏุงุฏู ุงููู ุงฺฏุฑ ูุงู ูุฌูุฏ ูุฏุงุดุชู ุจุงุดุฏ
ฺฉุงุฑูุง_ูพุฑูฺู = ุจุงุฑฺฏุฐุงุฑ_ุงุฒ_ูุงู() or [
    {
        "ูุงู": "ุทุฑุงุญ ุฑุงุจุท ฺฉุงุฑุจุฑ",
        "ุชุงุฑุฎ_ุดุฑูุน": "2025-04-01",
        "ูุฏุช_ุฒูุงู": 5,
        "ูุถุนุช": "ุชููู ุดุฏู",
        "ุงูููุช": "ุจุงูุง"
    },
    {
        "ูุงู": "ูพุงุฏู ุณุงุฒ ูพุงฺฏุงู ุฏุงุฏู",
        "ุชุงุฑุฎ_ุดุฑูุน": "2025-04-06",
        "ูุฏุช_ุฒูุงู": 7,
        "ูุถุนุช": "ุฏุฑ ุญุงู ุงูุฌุงู",
        "ุงูููุช": "ูุชูุณุท"
    }
]

# ููู ุงุตู
while True:
    print("\n๐ฏ ูุฏุฑุช ูพุฑูฺู")
    print("1. ููุงุด ฺฉุงุฑูุง")
    print("2. ูุฑุงุด ฺฉ ฺฉุงุฑ")
    print("3. ุฐุฎุฑู ุฏุฑ ูุงู")
    print("4. ุฎุฑูุฌ")

    ุงูุชุฎุงุจ = input("ุงูุชุฎุงุจ ุดูุง: ")

    if ุงูุชุฎุงุจ == "1":
        ููุงุด_ฺฉุงุฑูุง()
    elif ุงูุชุฎุงุจ == "2":
        ููุงุด_ฺฉุงุฑูุง()
        ุดูุงุฑู = int(input("ุดูุงุฑู ฺฉุงุฑ ุจุฑุง ูุฑุงุด: ")) - 1
        ูุฑุงุด_ฺฉุงุฑ(ุดูุงุฑู)
    elif ุงูุชุฎุงุจ == "3":
        ุฐุฎุฑู_ุฏุฑ_ูุงู()
    elif ุงูุชุฎุงุจ == "4":
        ุฐุฎุฑู_ุฏุฑ_ูุงู()
        print("๐ช ุฎุฑูุฌ ุงุฒ ุจุฑูุงูู...")
        break
    else:
        print("ูุทูุงู ฺฏุฒูู ูุนุชุจุฑ ูุงุฑุฏ ฺฉูุฏ.")
